This utility is designed to convert from OS2CIM to Mozilla MBOX (mail) format.  I had been planning to migrate from CompuServe for a couple of years, but when CompuServe recently made some changes to their system that cause problems with OS2CIM's filing system, it was the last straw, and I started looking for a way to move my substantial base of messages (collected over 10 years) from OS2CIM's fragile, proprietary .CIF format to something standardized, preferably Netscape's MBOX format.  

I found a shareware program that would permit migration from the CompuServe archive format (.CFT) to Eudora or Microsoft Exchange, but I thought $25 was a little too much for a utility that I only intended to use once, and for a file format that appeared easily deciphered with a hex editor.  I also found (on CompuServe) an old (1997) alpha version of a 16-bit Windows program that would convert from .CFT to a user-defined format, but the program GPFed after successfully converting only a few messages from my archives.  Not wanting to go to the bother of figuring out the .CFT format when somebody else had already started the job, I contacted Geoff Worboys, the author of the 16-bit program, and he was kind enough to send me some code containing the majority of the format information; I worked out a few minor additions and changes in the course of developing my own program.

I wrote this in REXX so that it can be easily revised and improved, and because of REXX's easy-to-follow code.  The tradeoff comes in speed:  Transferring roughly 15,000 messages from .CFT to Mozilla MBOX format took about 3.5 hours on my system (Athlon 1800, but a relatively slow Maxtor 18 MB hard drive --  most of the program is file reads/writes, which appear to be quite slow in REXX.)  The code is not pretty, but it should at least be fairly easy to follow.  

Mozilla's MBOX format is a slight variant of RFC822, which is easily found on the web.  It works well for storing e-mail messages, but less well for threads from CompuServe's forums: the threading information is lost.  It should be possible to convert threads to a newsreader format instead, but I saved almost no threads -- fewer than two dozen over ten years -- so I didn't bother; I leave the work to someone more motivated. :D

To use the program, archive your messages using the FCUTIL program provided with OS2CIM, and put the archive file(s) in the same directory as CIMCON.CMD.  To start the program, type CIMCON [archivename] at the command line; for example, for the file FCAB000.CFT, this would look like

CIMCON FCAB000.CFT

You will see a running count of messages converted, and files with the names of the folders you used in OS2CIM will begin to appear in the directory.  If the count stops for more than a few seconds, congratulations!  You have probably found a bug or a message variety not implemented in the program.  Dig into the archive with your favorite hex editor, and try to find the offending message.  Archives are sometimes corrupted:  I found one where the messages ended in the middle, and the rest of the file was zero-filled.  If you run into quirks or problems, it is probably worth your time to read through the program to find out how it handles some things (for example, folders with a slash in the name have the slash removed; if you have an "OS/2" folder, it will come out as "OS2").

If you have several archives, you can run the program on them sequentially, and the messages should be added to the correct files.  The program does NOT detect duplicate messages -- if you want to write some kind of code to detect and delete duplicates, it should be fairly straightforward, but I would expect it to slow down the program considerably.

Once you have completed processing the archives, move the resulting files to the desired directory under Mozilla\Profiles\[username]\[directory]\Mail (I used "Local Folders") and start Mozilla Mail.  The files will show up as subfolders, and will be automatically indexed when you access them.

The usual disclaimers apply:  There is no charge for any of this, and the program is not guaranteed to do anything at all.  However, I did spend a few hours on this, so I hope it works for you.  If you make improvements, please upload them to Hobbes and/or other OS/2 file repositories, for the further benefit of the OS/2-using multitudes.

I have also included a very basic program to convert the old WinCIM .PLX messages to something readable by Mozilla, but it only works on one message at a time.  I did this one because I had a dozen or so ancient WinCIM messages to convert, and the old OS2CIM conversion utility wouldn't recognize them for some reason.  This is even cruddier than CIMCON codewise, so you will have some programming to do if you want to convert more than a few files.

Richard Price