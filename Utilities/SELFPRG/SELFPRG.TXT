January 31 1993 
Jim Moriartey CIS 76330,1613

DISCLAIMER
I hope you find these programs useful, but I am
in no way responsible for any damages caused directly or
indirectly by the use or misuse of instself.cmd or the files
generated by instself.cmd may cause.
You are free to use instself.cmd and the generated Rexx 
programs at your own risk with no obligation to me,the author. 

The file instself.cmd and the generated files are FREEWARE.


FILES

instself.cmd          installs and generates the Rexx program.
selfprg.dat            used by instself.cmd to create the program.
selfprg.ico            the icon file set by instself.cmd.
selfprg.txt             this text file.
------------------------------------------------------------
This program will create an object that will display the archived 
files in the directory of your choice. You may then enter the
the archive file name to process. The program will unpack the
file you have chosen to the directory of your choice and create
objects of the programs and place them on the desktop.
This is a faster method of setting up archived files as objects 
then unpacking them and creating objects manually.

There are two Rexx programs in this package the first called
'instself.cmd'.This Rexx program will use the information that you
provide and the file 'selfprg.dat' to generate a custom Rexx
program and object.
You can create as many program/objects for different achievers
as you wish. Because the program information is keep in the Rexx
program there are no data files to be handled.

INSTALLING THE REXX PROGRAM\OBJECT

NOTE there is NO error checking so if an error occurs the install
or the program will fail.
To install/create the Rexx program open a OS/2 window switch to the
directory containing the Rexx files. 
Type in 'instself' hit enter
The first question that instself needs is what do you wish to call
this program/object. The question it will ask is shown below.

Enter the Name You wish to Call this Program (Example dozip.cmd)

Answer the question and press enter

 The next question is the archiver that you wish to use if the 
archiver is in the path just enter the name like 'PKunzip2' or if
it is not in the path enter the full path and name 'C:\OS2\UNZIP'.
If you are using a program like 'LH' that needs the switches add
them at this time also like 'C:\OS2\LH x'
The question it will ask is shown below.

 Enter the archiver You wish to Use (Example unzip unarj LH x)

Answer the Question and press enter

 The next question is the file extension to use enter zip for
zip files and so on.
The question it will ask is shown below.

Enter the Extension for the Archived files (Example zip arj lhz)
this information is needed to display the files for you to choose
in the program.

Answer the Question and press enter

 The next question is where do you want the program placed on your
hard drive. Enter the full drive and path name, the directory must
exist if it does not the install will fail.
The question it will ask is shown below.

 Enter PATH to the Archive Files (Example C:\ZIPS)
Directory must EXIST.

Answer the Question and press enter

 The install program will then ask you if the information is correct
if you answer with a N you can reenter the information, if you answer
Q the program will exit.

The program will then create a Rexx program with the options you 
have chosen and create a object of the same name and place it on 
the Desktop you can then drag and drop the object into any folder.

You can create as many of these Rexx program/objects as you
like using different archivers paths etc. The install program 
writes the data you supply into the Rexx program there are no data
files or config files.

USING the NEW PROGRAM\OBJECT

You will find the new program/object on the desktop it will be 
called the name you gave it during the install.
To use the program just double click on the object, a OS/2 window 
will open. You will be shown all of the archived files present,
type in the file name you wish to unpack and press enter.
The path is not needed just enter the file name.
The next question is where do you wish the file to be unpacked
if the directory does not exist the program will create it. Enter
in the drive and directory name. Like 'C:\TEST'. You should always
let the program create a new directory, when the program processes
the directory it will create objects for ALL files in the 
directory that meet the extension guidelines the program does not
check for duplicate objects.
If you unpack the archive to a directory containing some files 
they may end up on the Desktop.
 Next the program will display:

  the file name you wish to unpack
  the path to where it will be unpacked

If you answer 'q' or 'Q' the program will exit.
if you answer 'y' or 'Y' the program will create the directory
if it does not exist it will then unpack the file into the
directory. The program will then create a search file called
temp.lst.
The program will then read the search file and look for any
files that end in
bat
BAT
com
COM
exe
EXE
cmd
CMD
inf
INF
If it finds any 'inf' files it will create a 'View' object for the
information files. The program assumes that 'VIEW.EXE' is in the
path.
It will then create objects and place them on the Desktop to be 
used/deleted/moved as the user wishes.

ICON File Selfprg.ico

 The instself program sets the iconfile 'selfprg.ico' as the icon 
for the generated Rexx program to change the iconfile just
delete the file 'selfprg.ico' and copy a icon file you wish to use
and rename it 'selfprg.ico' or change the Icon via the settings
for the object. The Icon for the generated Rexx program will not 
be displayed until a system reboot.
This program was written on the 'fly' so the code is rough and 
there are debuging variables still in the files.
Beside the lack of error checking the programs run fine, if I get time
I may add error checking (doubtful). The file selfprg.dat is the main 
program and any one who wishes to add error checking or features 
is welcome to do so.

January 31 1993
